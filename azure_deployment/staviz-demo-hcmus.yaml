name: staviz-demo-hcmus
apiVersion: '2021-10-01'
location: southeastasia
properties:
  containers:
    - name: reverse-proxy
      properties:
        image: caddy:2-alpine
        ports:
          - protocol: TCP
            port: 80
          - protocol: TCP
            port: 443
        resources:
          requests:
            memoryInGB: 1.0
            cpu: 1.0
          limits:
            memoryInGB: 1.0
            cpu: 1.0
        volumeMounts:
          - name: proxy-caddyfile
            mountPath: /etc/caddy
          - name: proxy-data
            mountPath: /data
          - name: proxy-config
            mountPath: /config
          - name: static-files
            mountPath: /srv
    - name: example
      properties:
        image: docker.io/toanle9495/stavis-example
        ports:
          - port: 3838
            protocol: TCP
        environmentVariables:
          - name: PORT
            value: 3838
        resources:
          requests:
            memoryInGB: 1.0
            cpu: 1.0
          limits:
            memoryInGB: 1.0
            cpu: 1.0
    - name: dice
      properties:
        image: docker.io/toanle9495/stavis-dice
        ports:
          - port: 3839
            protocol: TCP
        environmentVariables:
          - name: PORT
            value: 3839
        resources:
          requests:
            memoryInGB: 1.0
            cpu: 1.0
          limits:
            memoryInGB: 1.0
            cpu: 1.0
  ipAddress:
    ports:
      - protocol: TCP
        port: 80
      - protocol: TCP
        port: 443
    type: Public
    dnsNameLabel: staviz-demo-hcmus
  osType: Linux
  volumes:
    - name: proxy-caddyfile
      azureFile:
        shareName: proxy-caddyfile
        storageAccountName: 'mytestcaddy'
        storageAccountKey: '/3Se4ZqvVy0Z12y8PYGGUzJPTQH4fLRmv1VABhM2LtwQqtFrGFs9Uy8pgDuP1Bw2HIX9xmJJEXVd+ASthXpASA=='
    - name: proxy-data
      azureFile:
        shareName: proxy-data
        storageAccountName: 'mytestcaddy'
        storageAccountKey: '/3Se4ZqvVy0Z12y8PYGGUzJPTQH4fLRmv1VABhM2LtwQqtFrGFs9Uy8pgDuP1Bw2HIX9xmJJEXVd+ASthXpASA=='
    - name: proxy-config
      azureFile:
        shareName: proxy-config
        storageAccountName: 'mytestcaddy'
        storageAccountKey: '/3Se4ZqvVy0Z12y8PYGGUzJPTQH4fLRmv1VABhM2LtwQqtFrGFs9Uy8pgDuP1Bw2HIX9xmJJEXVd+ASthXpASA=='
    - name: static-files
      azureFile:
        shareName: staviz-static-files
        storageAccountName: 'mytestcaddy'
        storageAccountKey: '/3Se4ZqvVy0Z12y8PYGGUzJPTQH4fLRmv1VABhM2LtwQqtFrGFs9Uy8pgDuP1Bw2HIX9xmJJEXVd+ASthXpASA=='
